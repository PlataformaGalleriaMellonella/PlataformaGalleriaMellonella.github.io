import{d as c,i as h}from"./chunk-YZFDS22F.js";import{O as o,R as n,W as r,oa as a}from"./chunk-BW4FWTPU.js";var p={production:!0,apiUrl:""};var E=(()=>{class i{constructor(t,e){this.http=t,this.router=e,this.API_URL=`${p.apiUrl}/auth`,this.TOKEN_KEY="access_token",this.isAuthenticated=a(this.hasValidToken())}login(t,e){return this.http.post(`${this.API_URL}/login`,{email:t,password:e}).pipe(o(s=>{localStorage.setItem(this.TOKEN_KEY,s.access_token),this.isAuthenticated.set(!0)}))}register(t,e){return this.http.post(`${this.API_URL}/register`,{name:t,email:e}).pipe(o(s=>{this.isAuthenticated.set(!1)}))}logout(){localStorage.removeItem(this.TOKEN_KEY),this.isAuthenticated.set(!1),this.router.navigate(["comunidade","login"])}getToken(){return localStorage.getItem(this.TOKEN_KEY)}hasValidToken(){let t=this.getToken();if(!t)return!1;try{return JSON.parse(atob(t.split(".")[1])).exp>Date.now()/1e3}catch{return!1}}static{this.\u0275fac=function(e){return new(e||i)(r(c),r(h))}}static{this.\u0275prov=n({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{E as a};
