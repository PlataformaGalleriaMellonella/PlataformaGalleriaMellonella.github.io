import{d as h,i as p}from"./chunk-YZFDS22F.js";import{O as o,R as a,W as r,oa as n}from"./chunk-BW4FWTPU.js";var c={production:!0,apiUrl:""};var A=(()=>{class i{constructor(t,e){this.http=t,this.router=e,this.API_URL=`${c.apiUrl}/auth`,this.TOKEN_KEY="access_token",this.isAuthenticated=n(this.hasValidToken())}login(t,e){return this.http.post(`${this.API_URL}/login`,{email:t,password:e}).pipe(o(s=>{localStorage.setItem(this.TOKEN_KEY,s.access_token),this.isAuthenticated.set(!0)}))}register(t,e){return this.http.post(`${this.API_URL}/register`,{name:t,email:e}).pipe(o(s=>{this.isAuthenticated.set(!1)}))}forgotPassword(t){return this.http.post(`${this.API_URL}/forgot-password`,{email:t})}logout(){localStorage.removeItem(this.TOKEN_KEY),this.isAuthenticated.set(!1),this.router.navigate(["comunidade","login"])}getToken(){return localStorage.getItem(this.TOKEN_KEY)}hasValidToken(){let t=this.getToken();if(!t)return!1;try{return JSON.parse(atob(t.split(".")[1])).exp>Date.now()/1e3}catch{return!1}}static{this.\u0275fac=function(e){return new(e||i)(r(h),r(p))}}static{this.\u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{A as a};
