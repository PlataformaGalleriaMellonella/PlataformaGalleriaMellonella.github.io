import{d as n,i as c}from"./chunk-65VJDJBJ.js";import{O as r,R as s,W as o,oa as a}from"./chunk-6KXK6ZF3.js";var h={production:!0,apiUrl:""};var I=(()=>{class i{constructor(t,e){this.http=t,this.router=e,this.API_URL=`${h.apiUrl}/auth`,this.TOKEN_KEY="access_token",this.isAuthenticated=a(this.hasValidToken())}login(t,e){return this.http.post(`${this.API_URL}/login`,{email:t,password:e}).pipe(r(l=>{localStorage.setItem(this.TOKEN_KEY,l.access_token),this.isAuthenticated.set(!0)}))}logout(){localStorage.removeItem(this.TOKEN_KEY),this.isAuthenticated.set(!1),this.router.navigate(["/login"])}getToken(){return localStorage.getItem(this.TOKEN_KEY)}hasValidToken(){let t=this.getToken();if(!t)return!1;try{return JSON.parse(atob(t.split(".")[1])).exp>Date.now()/1e3}catch{return!1}}static{this.\u0275fac=function(e){return new(e||i)(o(n),o(c))}}static{this.\u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{I as a};
